<%- include('../partials/header.ejs')%>
<body class="fullpage">
    <main class="editpage">
        <br>
        <h1 class="edit_a_connection">Edit a Connection</h1>
        <br>    
        <form method="POST" action="/events/<%= event.id %>?_method=PUT" enctype="multipart/form-data">
            <div class="form-group">
                <label for="category">Category</label>
                <select name="category" id="category" required onchange="showOtherInput(this)">
                    <option value="">-Select-a-Category-</option>
                    <%categories.forEach(category => {%>
                        <%if(category === event.category){%>
                            <option value="<%= category%>" selected><%= category%></option>
                        <%}
                        else{%>
                            <option value="<%= category%>"><%= category%></option>
                        <%}%>
                    <%})%>
                    <option value="Other">Other</option>
                </select>
                <label for="newCategoryInput"></label>
                <input type="text" name="newCategoryInput" id="newCategoryInput" style="display: none;" placeholder="Enter new category">
            </div>
            <br>
            <div class="form-group">
                <label for="title">Title</label>
                <input type="text" name="title" id="title" placeholder="Enter the title of your connection" value="<%= event.title%>" required>
            </div>
            <br>
            <div class="form-group">
                <label for="details">Details</label>
                <input type="text" name="details" id="details" placeholder="Enter the details of your connection" value="<%= event.details%>" required>
            </div>
            <br>
            <div class="form-group">
                <label for="location">Where</label>
                <input type="text" name="location" id="location" placeholder="Enter the location of your connection" value="<%= event.location%>" required>
            </div>
            <br>
            <div class="form-group">
                <label for="start_date_time">Start</label>
                <input type="datetime-local" name="start_date_time" id="time_start" value="<%= event.start_date_time.toISOString().slice(0, 16)%>" required>
            </div>
            <br>
            <div class="form-group">
                <label for="end_date_time">End</label>
                <input type="datetime-local" name="end_date_time" id="time_end" value="<%= event.end_date_time.toISOString().slice(0, 16)%>" required>
            </div>
            <br>
            <div class="form-group">
                <!-- <div class=""> -->
                <label for="img">Image</label>
                <input type="file" name="img" id="upload">
                <!-- </div> -->
            </div>
            <br><br>
            <input class="btn btn-primary" type="submit" value="Edit Connection">
            <br>
            <br>
            <br><br><br><br>
            

        </form>

    </main>
    <script>
        function showOtherInput(selectElement) {
            var newCategoryInput = document.getElementById("newCategoryInput");
            if (selectElement.value === "Other") {
                newCategoryInput.style.display = "block";
                newCategoryInput.setAttribute("required", "true");
            } else {
                newCategoryInput.style.display = "none";
                newCategoryInput.removeAttribute("required");
            }
        }
    </script> 
</body>  
<%- include('../partials/footer.ejs')%>